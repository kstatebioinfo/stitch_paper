%% BioMed_Central_Tex_Template_v1.06
%%                                      %
%  bmc_article.tex            ver: 1.06 %
%                                       %

%%IMPORTANT: do not delete the first line of this template
%%It must be present to enable the BMC Submission system to
%%recognise this template!!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                     %%
%%  LaTeX template for BioMed Central  %%
%%     journal article submissions     %%
%%                                     %%
%%          <8 June 2012>              %%
%%                                     %%
%%                                     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% For instructions on how to fill out this Tex template           %%
%% document please refer to Readme.html and the instructions for   %%
%% authors page on the biomed central website                      %%
%% http://www.biomedcentral.com/info/authors/                      %%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%% BioMed Central currently use the MikTex distribution of         %%
%% TeX for Windows) of TeX and LaTeX.  This is available from      %%
%% http://www.miktex.org                                           %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% additional documentclass options:
%  [doublespacing]
%  [linenumbers]   - put the line numbers on margins

%%% loading packages, author definitions

%\documentclass[twocolumn]{bmcart}% uncomment this for twocolumn layout and comment line below
\documentclass{bmcart}

%%% Load packages
%\usepackage{amsthm,amsmath}
%\RequirePackage{natbib}
\RequirePackage{hyperref}
\usepackage{hyperref}
\usepackage[utf8]{inputenc} %unicode support
%\usepackage[applemac]{inputenc} %applemac support if unicode package fails
%\usepackage[latin1]{inputenc} %UNIX support if unicode package fails


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                             %%
%%  If you wish to display your graphics for   %%
%%  your own use using includegraphic or       %%
%%  includegraphics, then comment out the      %%
%%  following two lines of code.               %%
%%  NB: These line *must* be included when     %%
%%  submitting to BMC.                         %%
%%  All figure files must be submitted as      %%
%%  separate graphics through the BMC          %%
%%  submission process, not included in the    %%
%%  submitted article.                         %%
%%                                             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\def\includegraphic{}
\def\includegraphics{}



%%% Put your definitions there:
\startlocaldefs
\endlocaldefs


%%% Begin ...
\begin{document}

%%% Start of article front matter
\begin{frontmatter}

\begin{fmbox}
\dochead{Research}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the title of your article here     %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Tools and pipelines for BioNano data: molecule assembly pipeline and FASTA super scaffolding tool}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors here                   %%
%%                                          %%
%% Specify information, if available,       %%
%% in the form:                             %%
%%   <key>={<id1>,<id2>}                    %%
%%   <key>=                                 %%
%% Comment or delete the keys which are     %%
%% not used. Repeat \author command as much %%
%% as required.                             %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author[
   addressref={aff1},                   % id's of addresses, e.g. {aff1,aff2}
   %noteref={n1},                        % id's of article notes, if any
   email={sheltonj@ksu.edu}   % email address
]{\inits{JM}\fnm{Jennifer M} \snm{Shelton}}
\author[
addressref={aff1},                   % id's of addresses, e.g. {aff1,aff2}
%noteref={n1},                        % id's of article notes, if any
email={cmgordon@ksu.edu}   % email address
]{\inits{MC}\fnm{Michelle C} \snm{Coleman}}
\author[
addressref={aff1},                   % id's of addresses, e.g. {aff1,aff2}
%noteref={n1},                        % id's of article notes, if any
email={nherndon@ksu.edu}   % email address
]{\inits{N}\fnm{Nic} \snm{Herndon}}
\author[
addressref={aff1},                   % id's of addresses, e.g. {aff1,aff2}
%noteref={n1},                        % id's of article notes, if any
email={nanyan@ksu.edu}   % email address
]{\inits{N}\fnm{Nanyan} \snm{Lu}}
\author[
   addressref={aff2},
   email={Elam@bionanogenomics.com} % email address
]{\inits{ET}\fnm{Ernest E} \snm{Lam}}
\author[
   addressref={aff2},
   email={tanantharaman@bionanogenomics.com} % email address
]{\inits{T}\fnm{Thomas} \snm{Anantharaman}}
\author[
   addressref={aff1},
      corref={aff1},                       % id of corresponding address, if any
   email={sjbrown@ksu.edu} % email address
]{\inits{SJ}\fnm{Susan J} \snm{Brown}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors' addresses here        %%
%%                                          %%
%% Repeat \address commands as much as      %%
%% required.                                %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\address[id=aff1]{%                           % unique id
  \orgname{Department of Biology, Kansas State University}, % university, etc
  %\street{},                     %
  %\postcode{66506}                                % post or zip code
  \city{Manhattan},                              % city
  \cny{KS, USA}                                    % country
}
\address[id=aff2]{%                           % unique id
  \orgname{BioNano Genomics}, % university, etc
  %\street{},                     %
  %\postcode{92121}                                % post or zip code
  \city{San Diego},                              % city
  \cny{CA, USA}                                    % country
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter short notes here                   %%
%%                                          %%
%% Short notes will be after addresses      %%
%% on first page.                           %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{artnotes}
%\note{Sample of title note}     % note to the article
\note[id=n1]{Equal contributor} % note, connected to author
\end{artnotes}

\end{fmbox}% comment this for two column layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Abstract begins here                 %%
%%                                          %%
%% Please refer to the Instructions for     %%
%% authors on http://www.biomedcentral.com  %%
%% and include the section headings         %%
%% accordingly for your article type.       %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstractbox}

\begin{abstract} % abstract
\parttitle{Background} %if any
Text for this section.
\parttitle{Results} %if any
In this article we present software that leverages BioNano genome maps assembled from ultra-long single molecule maps to improve the contiguity of sequence assemblies. We report the results of applying these tools to a 7x Sanger draft of the \textit{Tribolium castaneum} genome.
\parttitle{Conclusions} %if any
\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The keywords begin here                  %%
%%                                          %%
%% Put each keyword in separate \kwd{}.     %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{keyword}
\kwd{Genome map}
\kwd{BioNano}
\kwd{Genome scaffolding}
\kwd{Genome validation}
\kwd{Genome finishing}
\end{keyword}

% MSC classifications codes, if any
%\begin{keyword}[class=AMS]
%\kwd[Primary ]{}
%\kwd{}
%\kwd[; secondary ]{}
%\end{keyword}

\end{abstractbox}
%
%\end{fmbox}% uncomment this for twcolumn layout

\end{frontmatter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Main Body begins here                %%
%%                                          %%
%% Please refer to the instructions for     %%
%% authors on:                              %%
%% http://www.biomedcentral.com/info/authors%%
%% and include the section headings         %%
%% accordingly for your article type.       %%
%%                                          %%
%% See the Results and Discussion section   %%
%% for details on how to create sub-sections%%
%%                                          %%
%% use \cite{...} to cite references        %%
%%  \cite{koon} and                         %%
%%  \cite{oreg,khar,zvai,xjon,schn,pond}    %%
%%  \nocite{smith,marg,hunn,advi,koha,mouse}%%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%% start of article main body
% <put your article body there>

%%%%%%%%%%%%%%%%
%% Background %%
%%
\section*{Background}
The quality of genome assemblies varies greatly. Initial assembly drafts, whether based on lower coverage Sanger or higher coverage NGS reads, are often highly fragmented. Physical maps of BAC clones are often used to validate and scaffold sequence assemblies, but the molecular, human and computational resources required to significantly improve a draft genome are not often available to researchers working on non-model organisms. The BioNano Irys platform provides affordable, high throughput physical maps with significantly higher contiguity with which to validate draft assemblies and extend scaffolds.

\subsection*{Data formats}
The tools described make use of three file formats developed by BioNano. The Irys platform images ultra-long molecules of genomic DNA that are nick-labeled at 7 (bp) motifs using one or more nicking endonucleases and fluorescently labeled nucleotides. Molecules captured in the TIFF images are converted to BNX format text files that include label position for each molecule (steps 1 and 2 Figure 1). These BNX files are referred to as molecule maps. Consensus Map (CMAP) files include the molecule length and label position for long genomic regions that are either inferred from assembly of BNX molecules (steps 7 and 8 Figure 1) or \textit{in silico} from sequence scaffolds (steps 3 and 4 Figure 1). These two types of CMAPs are referred to as BioNano genome maps and \textit{in silico} genome maps respectively. The alignment of two CMAPs is stored as an XMAP text file that includes alignment coordinates and an alignment confidence score (step 10 Figure 1).

\subsection*{Other software tools}
HybridScaffold from BioNano was developed to create more contiguous genome maps using information from both sequence and map data. These more contiguous genome maps can then be used to create more contiguous sequence assemblies. The hybridScaffold software first creates hybrid \textit{in silico}/BioNano genome map contigs from a filtered XMAP alignment file. The output genome maps are called hybrid scaffolds and are aligned to the original \textit{in silico} genome maps. This alignment is used to output a FASTA file of sequence super scaffolds. These sequences include ambiguous bases to indicated where labels occur within gaps. Because they include extensions into regions with genome maps but no sequence data they may begin or end with N gaps. HybridScaffold only generates  hybrid \textit{in silico}/BioNano genome map contigs, and therefore super scaffolds, if no conflict (e.g. negative gap lengths or otherwise conflicting alignments) are indicated by the alignment of \textit{in silico} and BioNano genome maps. All conflicting alignments are excluded from the hybrid scaffold genome map and flagged for further evaluation at the sequence level. For highly refined genome assemblies this lack of tolerance for noisy alignments has not hindered genome improvement projects. However, for genomes at an earlier stage of completion this may be too stringent.

\section*{Implementation}
\subsection*{Assembly preparation}
We have developed AssembleIrysCluster to prepare BNX files for assembly and produce nine customized assembly scripts (sections C-G Figure 2).
\subsubsection*{Molecule Stretch}
In the first stage, AssembleIrysCluster adjusts molecule stretch (section C Figure 2). BioNano software operates under the assumption that imaged molecules contain 500 bases per pixel (bpp). Stretch, or bpp, can deviate from 500 bpp and this discrepancy can vary from scan to scan within a flowcell (Additional file 1). Sequence scaffolds are considered to be more accurate than raw BNX molecules in terms of label position. Therefore molecule maps in a BNX files are split by scan number and after alignment to the \textit{in silico} genome map an empirical bpp value is determined for the molecule maps in each scan. The bpp indicated by this alignment is used by RefAligner to adjust molecule map bpp to 500. Once stretch has been evaluated and adjusted the split BNX files are merged into a single file (section E Figure 2).

We observed consistent patterns of empirically determined bpp between flowcells using the same flow cell model and chemistry when signal-to-noise ratios are optimal and the degree of genomic divergence between the samples used for the \textit{in silico} genome map and molecule maps are low (Additional file 1). To identify the low quality flowcells bpp observed in alignments of scans are plotted as a QC graph (section D Figure 2). 

\subsubsection*{Customization of BioNanoAssembly Scripts}

In the next stage, AssembleIrysCluster creates various assembly scripts to explore a range of parameters with the goal of selecting the optimal assembly for downstream analysis (sections F-G Figure 2). Molecule maps in the adjusted merged BNX file are aligned to the \textit{in silico} genome map. An alignment error profile generated by RefAligner is used with the estimated genome length to calculate default assembly parameters, and the eight other scripts include variants of these parameters. Initially three assemblies are run, the first with $p\textnormal{-}Value Threshold Default = \frac{1e-5}{Genome Length (Mb)}$, the second with  $p\textnormal{-}Value Threshold Strict = \frac{p\textnormal{-}Value Threshold}{10}$ and the third with $p\textnormal{-}Value Threshold Relaxed = {p\textnormal{-}Value Threshold} \times {10}$ (section F Figure 2). Minimum molecule length is set to 150 kb. If one of these runs does not produce a satisfactory assembly then two minimum molecule length variants (180 kb and 100 kb) are tested with the $p\textnormal{-}Value Threshold$ of the current best assembly (section G Figure 2). Between three and nine assemblies are run until a satisfactory assembly is produced.

\subsubsection*{BioNano Assembly Optimization}

The ultimate goal is to produce a BioNano genome map that can be used to guide sequence-based haploid reference genome assembly. While BioNano genome maps can be used to reconstruct haplotypes \cite{MHCLam}, genome assembly involves collapsing polymorphisms arbitrarily into a consensus reference genome. Therefore the length of an ideal BioNano genome map should equal the haploid genome length. Additionally, 100\% of the BioNano genome map would align non-redundantly to 100\% of the \textit{in silico} genome map. When BioNano genome maps are imperfect, optimal assembly length is balanced against alignment redundancy to select the best assembled BioNano genome map.

\subsubsection*{Stitch: Alignment Filters}

The Stitch algorithm uses alignments, or XMAPs, of query to reference genome maps to predict higher order arrangement of genome scaffolds  (Figure 3). RefAligner assumes the reference genome map has the error profile of an \textit{in silico} genome map and the query has the error profile of a BioNano genome map. Therefore alignments run with the \textit{in silico} genome map as the reference, are inverted and sorted by BioNano genome map coordinates for efficient parsing by Stitch (section A and B Figure 3). 

Before inferring super scaffolds from XMAPs, Stitch filters low quality alignments by confidence score. Alignments of \textit{in silico} and BioNano genome maps are assigned a confidence score that is the $-log10$ of the $False\textnormal{ }Positive\textnormal{ }p\textnormal{-}Value$. Misaligned labels and sizing error increase the alignment $False\textnormal{ }Positive\textnormal{ }p\textnormal{-}Value$ and decrease confidence scores \cite{ProbFP} .

Super scaffolds are built from overlapping alignments. Overlapping alignments are similar to global alignments, i.e. alignments spanning from end to end for two maps of roughly equal length, but to search for overlap alignments gaps after the ends of either map are not penalized. The RefAligner scoring scheme does not currently have a parameter to favor overlapping alignments, e.g. to initialize the dynamic programming matrix with no penalties and take the maximum score of the final row or column in the matrix. Refaligner reports local alignments between two maps and applies a fixed penalty based on the user defined likelihood of unaligned labels at the ends of an alignment. Raising or lowering this penalty selects for local or global alignments respectively but neither option favors overlapping alignments specifically. Stitch filters by the percent of the total possible alignment length that is aligned (section C Figure 3). To approximate scoring that favors overlapping alignments Stitch uses thresholds for minimum percent of total possible aligned length, the percent aligned threshold (PAT). 

Similar to scoring structures that favor overlapping alignments, PAT filters out local alignments. However, unlike a scoring structure PAT is applied after alignment and therefore cannot result in the aligner exploring possible extensions into an overlap but instead favors a shorter local alignment with a higher cumulative score. Therefore Stitch accepts alignments with less than 100\% PAT. Default values for the PAT were determined empirically after reviewing the degree to which filtered alignments agreed with the independently derived genetic maps of \textit{T. castaneum} and by visual inspection of alignments.

In practice we used two sets of alignment filters and kept alignments that passed one or both sets. The first set had a low PAT and a high confidence score threshold. The second set had a higher PAT and a lower confidence score and was intended identify longer overlaps especially in regions of the genome where label density is low.

\subsubsection*{Stitch: Super Scaffolding}

Scaffolding alignments are selected from the remaining high quality alignments (i.e. more than one \textit{in silico} genome map aligns to the same BioNano genome map (section D Figure 3)). For each \textit{in silico} genome map with more than one high quality, scaffolding alignment the longest alignment in base pairs is selected (section D and E Figure 3). If alignment length is identical then the highest confidence alignment is selected. If confidence scores are identical then an alignment is chosen arbitrarily.

Gap lengths between \textit{in silico} genome maps are inferred from scaffolding alignments and used to create new super scaffolds (section F Figure 3) in a new genome FASTA file and associated AGP file. If gap lengths are estimated to be negative, Stitch adds a 100 bp spacer gap to the sequence file and indicates that the gap is type "U" for unknown in the AGP. 

Stitch only makes use of one alignment per \textit{in silico} map per iteration. Stitch can be run iteratively (steps 10-15 Figure 1) such that each successive output FASTA file is converted into an \textit{in silico} genome map and aligned to the original BioNano genome map. This alignment is inverted and used as input for the next iteration. Subsequent iterations of Stitch will make use of any \textit{in silico} genome maps that join growing super scaffolds, effectively using both sequence data and genome maps to stitch together the final super scaffolds (section G-H Figure 3). 

\subsubsection*{Stitch: Flagging Potential Mis-assemblies}

This algorithm is meant to be an intermediate refinement of draft genomes prior to further fine scale refinement at the sequence level. Inconsistencies between the BioNano genome maps and the \textit{in silico} genome maps are reported in output logs to facilitate downstream sequence editing. If an alignment passes initial confidence score and PAT filtering but has a PAT less then 60\%, this is reported as a partial alignment. A partial alignment may occur if either the sequence scaffold or the BioNano genome map is a chimeric assembly. Additionally, if a gap length is estimated to be negative it may indicate that the sequence scaffolds can be joined with a local assembly or that a chimeric sequence mis-assembly needs to be broken within a scaffold. Assembly errors in the BioNano genome maps or spurious alignments could also result in either of these cases. Ideally researchers could make use of the alignment of genomic sequence reads to the genome sequence assembly and the alignment of BioNano molecule maps to the BioNano genome map to determine which assembly is likely to be incorrect.
 
\section*{Results and Discussion}

\subsubsection*{Datasets}
High molecular weight DNA was isolated from young \textit{Tribolium castaneum} pupae from the GA2 line that was inbred 20 generations. The GA2 line was also used for the genome sequence based assembly.

Using Knickers, an \textit{in silico} label density calculator, we estimated that the \textit{Tribolium castaneum} genome had 8.66 nt.BspQI labels per 100 kb and 5.51nt.BbvCI labels per 100 kb. The ideal number of labels per 100 kb is between 10 and 15 therefore we dual nicked with both enzymes. DNA was nicked, labeled with flourescent nucleotides and repaired according to BioNano protocol and 93 BNX files were produced from the Irys genome mapping platform (Figure 4 and Additional file 2). Four corrupted files (cumulative length = 0) were excluded from this analysis. 

The high number of BNX files produced is due to several factors. Typically one BNX file is produced per flowcell, however the Irys chips are reusable therefore if nano channels are clear after the initial number of scans additional scans are run producing an additional BNX file. Another reason for the large number of files is that data was originally generated using the Irys V1 chip while the Irys platform was under beta testing. Over time maximum cumulative length per BNX file increased (Figure 4 and Additional file 2). After the upgrade to the V2 chip an increase was also observed in maximum data per BNX file (Figure 4 and Additional file 2).

Molecule map quality metrics were calculated using bnx\_stats (version 1.0). We generated $\sim$250x coverage of the \textit{T. castaneum} genome for molecule maps $>$150 kb, the default minimum molecule map length. The 239,558 molecule maps with lengths $>$150kb had an N50 of 202.63 kb and a cumulative length of 50,579.12 Mb (Table 1). Histograms of per-molecule quality metrics for maps after applying a minimum length filter of either 100 kb, 150 kb and 180kb are reported in Additional file 3. 

To generate the \textit{in silico} genome map we used the sequence-based assembly scaffolds from version 5.0 of the \textit{Tribolium castaneum} genome (Tcas5.0). Version 5.0 (Table 2) of the \textit{T. castaneum} genome is an updated version of the sequence assembly that was created by adding 1.03 Mb of sequence to version 3.0 \cite{Beetle2008}. Two hundred and twenty-three of the 2240 scaffolds within Tcas5.0 were longer than 20 kb with more than 5 labels, the minimum requirements for an \textit{in silico} genome map contig, however these longer sequence scaffolds represent the bulk of the sequence assembly, 152.53 of the 160.74 Mb (Table 2).

%% Between version 3.0 \cite{Beetle2008} and version 5.0 (Table 2) of the \textit{T. castaneum} genome 1.03 Mb of sequence was added for a length of 160.74 Mb in 2,240 scaffolds after linking with Atlas-Link (version 0.01) and gap filling with GapFiller (version 1.10).

\subsubsection*{Assembly: Selecting the Optimal BioNano Assembly}
Molecule maps were assembled into five distinct BioNano genome maps for \textit{T. castaneum}. 

Molecule maps were prepared for assembly (section C Figure 2) and noise parameters were estimated (section D and E Figure 2) using AssembleIrysCluster (version 1.0). Next, three genome maps were assembled using the relaxed, default and strict ”-T” parameters (5e-10, 5e-09 and 5e-08), the stretch-adjusted molecule maps and customized noise parameters. Assemblies with these p-value thresholds are named $Relaxed\textnormal{-}T$, $Default\textnormal{-}T$ and $Strict\textnormal{-}T$ respectively. 

In the first round of selection, the $Strict\textnormal{-}T$ assembly was the best of these three assemblies because it has a cumulative length close to 200 Mb (Table 2 and Figure 5), the estimated size of the \textit{T. castaneum} genome, and a small difference between non-redundant aligned length, breath of alignment, and total aligned length (Figure 5, Table 3 and Additional file 4). Thus in the second round of selection, $Strict\textnormal{-}T$ parameter was used for two further assemblies that had relaxed minimum molecule length ($Relaxed\textnormal{-}Minlen$) of 100 kb rather than the 150 kb default or a strict minimum molecule length ($Strict\textnormal{-}Minlen$) of 180 kb. The $Strict\textnormal{-}TAndStrict\textnormal{-}Minlen$ assembly improved alignments by reducing redundancy slightly. However the cumulative length of the assembly is 21.45 Mb smaller than the estimated genome size. The $Strict\textnormal{-}TAndRelaxed\textnormal{-}Minlen$ assembly has a worse cumulative length and alignment redundancy than the $Strict\textnormal{-}T$ assembly. Because neither of the assemblies using 100 or 180 kb as the minimum molecule length improved both assembly metrics when compared to the $Strict\textnormal{-}T$ assembly, generated in the first round of selection with the default $Minlen$ of 150 kb, the $Strict\textnormal{-}T$ assembly will be referred to as the \textit{T. castaneum} BioNano genome map in further analysis.

The \textit{T. castaneum} BioNano genome map has an N50 of 1.35 Mb, a cumulative length of 200.47 Mb and 216 genome map contigs (Table 2 and Figure 4). Assembly metrics were calculated using the BNGCompare script (version 1.0). More detailed assembly metrics for all five assembled genome maps are available in Additional file 4.

\subsubsection*{Stitch: Automated and Manually Edited Assemblies}

Tcas5.1 is the output of Stitch (version 1.4.4) run for five iterations with two sets of alignment filters. To select quality alignments from regions of high and low label density, the first minimum confidence was 13 and the $PAT$ was 30 and the second minimum confidence was 8 and the $PAT$ was 90. The resulting superscaffolds showed a greater than three fold increase in N50 from 1.16 to 3.85 Mb (Table 2). 

The Tcas5.1 super scaffolds captured an additional 92 gaps between Tcas5.0 sequence scaffolds. Sixty-six gaps were estimated to have positive gap lengths and were represented in the sequence assembly with their estimated size (Figure 6). Twenty-six gaps were estimated to have negative lengths and were represented with spacers of 100 N's (Figure 6). Extremely small negative gap lengths ($< -20$ kb) were flagged for further evaluation at a sequence level. In some cases extremely small negative gaps lengths suggest that a chimeric sequence scaffold may need to be broken at the sequence level and its fragments incorporated into different ChLGs. For example, half of scaffold 81 from Tcas5.0 aligns between the scaffolds 80 and 82 on ChLG5 (section A Figure 7) while the other half aligns between scaffolds 102 and 103 from ChLG7 (section B Figure 7). Scaffold 81 from Tcas5.0 was placed in ChLG5 in the \textit{T. castaneum} genetic map. The arrangement supported by the genetic map was selected for cases like this where manual editing was required. The manually curated assembly is referred to as Tcas5.2. In Tcas5.2 joins were also manually accepted if they agree with the genetic map but the alignment quality was low. Ultimately, Tcas5.2 had a higher N50 than the automated Stitch output, 4.46 Mb (Table 2), with 66 gaps with positive estimated lengths and 24 negative length gaps. 

Nearly every ChLG was less fragmented in the Tcas5.2 assembly than in the Tcas5.0 assembly. The number of scaffolds was reduced for each ChLG (Table 4) except for the 26 relatively short (N50 = 0.05 Mb) and unlocalized scaffolds from ChLGY. For example, ChLGX was reduced from 13 scaffolds (section B Figure 8) to 2 in the final super scaffold or chromosome build (section A Figure 8). Five scaffolds were reoriented in ChLGX based on alignment to the BioNano genome maps (section A and B Figure 8). Scaffolds were also reordered based on alignment to BioNano genome maps. For example, scaffold 2 from ChLGX aligned between scaffold 36 and 37 of ChLG 3 and was therefore moved in Tcas5.2 (Additional file 5). Also, 19 previously unplaced scaffolds were anchored within a ChLG (Table 4). Improvements in Tcas5.2 over Tcas5.0 are shown in alignments of the respective \textit{in silico} genome maps to BioNano genome maps  for all ChLGs in Additional file 5.

The Tcas5.2 Whole Genome Shotgun project has been deposited at DDBJ/EMBL/GenBank under the accession AAJJ00000000. The version described in this paper is version AAJJ02000000. Two scaffolds were removed from the genome assembly because they were identified as contaminants after they blasted to the \textit{Bos frontalis} genome.

\subsubsection*{Assembly: Putative Haplotypes}

We found evidence of putative haplotypes during visual inspection of alignments. Although overall alignment redundancy was low for the $Strict\textnormal{-}T$ assembly, where redundant alignments of BioNano genome map contigs occurred often two contigs aligned to the same \textit{in silico} genome map contig. Redundancy in alignment to the \textit{in silico} genome map contig could indicate segmental duplications, assembly of alternative haplotypes in the BioNano genome map contigs, mis-assembly producing redundant contigs in the BioNano genome map or collapsed repeats in the sequence-based assembly. A typical redundant alignment is shown in Figure 9, where a small region of one BioNano genome map contig aligns while another aligns across most of the \textit{in silico} genome map contig (section A Figure 9). Molecule map coverage decreases for each BioNano map contig in the region where only one of them aligns to the \textit{in silico} genome map contig (section A,B and C Figure 9). Taken together the region of lower coverage and the number of contigs aligning (two) may indicate the assembly of two haplotypes. 

\subsubsection*{Stitch: Comparison to Other Software}

We also ran hybridScaffold (version 3076) from BioNano to improve the \textit{T. castaneum} sequence assembly using the \textit{T. castaneum} BioNano genome map and the \textit{in silico} genome map from Tcas5.0. HybridScaffold improved sequence-based assembly N50 from 1.16 Mb for Tcas5.0 to 1.83 Mb however the increase in N50 was not as great as the increase after running Stitch ( N50 = 3.85 Mb) (Table 2). HybridScaffold decreased the total number of scaffolds in the sequence assembly by 30 scaffolds while Stitch reduced the number of scaffolds by 92. Hybrid scaffold increased the cumulative length of the assembly by 14.80 Mb while Stitch only increased the length of the assembly by 4.98 Mb. The increase in length from hybridScaffold may be due to extension of sequence-based scaffolds with genome map contigs that overlap the start of end of a sequence-based scaffold.

Overall, we found hybridScaffold to be more aggressive than Stitch. In Figure 8 section B, 13 \textit{in silico} genome map contigs align to three BioNano map contigs. The order of 11 of these \textit{in silico} genome maps contigs agrees with the order suggested by the genetic map (after reorienting three \textit{in silico} genome maps contigs). The \textit{in silico} genome map contigs 12 and 13, for example, align with a negative gap length between them, suggesting they may be mis-assembled or that local assembly may collapse the assembly in this region. A genome refinement tool like Stitch or hybridScaffold could take several approaches to this kind of conflicting evidence. The approach of Stitch would be to record that we have confirmed the relative position of these scaffolds in the larger context of they genome in a new super scaffold using a 100 bp spacer gap to indicate that exact overlap or gap length is unclear (section A Figure 8). Stitch would also report the negative gap length to the user to allow further evaluation at the sequence level at a later date. Alternatively, hybridScaffold would only automate genome improvements that are unambiguously supported by all lines of evidence (e.g. sequence-based and BioNano map-based) and leave any ambiguous decisions to a human curator. Therefore hybridScaffold would only report the conflicting alignment. This is why only scaffold 13, for example, is not included in the hybrid map produced by hybridScaffold (section C Figure 8). 

For highly refined genome assemblies this lack of tolerance for noisy alignments has not hindered genome improvement projects. However, for genomes at an earlier stage of completion this may be too stringent. The hybridScaffold software, for example, was developed to scaffold the human genome and found to work well for this application (CITE NATURE METHODS PAPER). For smaller genome projects assembly updates may need to be released in stages (e.g. first the general improvement in scaffold order and orientation followed by further refinement at the sequence level). For projects such as \textit{T. castaneum} a more aggressive algorithm such as Stitch may be preferred in order to release the bulk of the new information about the higher order arrangement of the genome to the community of \textit{T. castaneum} researchers quickly. Further refinement at a sequence level can be released in subsequent genome updates as they are completed.

\section*{Conclusions}

We introduced new tools to facilitate BioNano molecule map assembly optimization genome finishing steps with the resultant BioNano genome maps. These tools were validated using the medium-sized (200 Mb) beetle genome from \textit{T. castaneum}. While the \textit{T. castaneum} genome was originally assembled using the gold-standard Sanger assembly strategy and had the benifit of extensive genetic maps and LongDistance Illumina Jump libraries, Stitch more than tripled the genome N50. 

As the variety of genome assembly projects increases tools that are appropriate for all projects (e.g. any size, assembly quality, taxonomic group, etc.) may not exist. Indeed, the results of Assemblation2 indicate that no one suite of datatypes or assembly workflow may be sufficient to best assemble even the subcategory vertabrate genomes \cite{Assem22013}. 

Regions where BioNano genome map contigs disagree with sequence assemblies (e.g. negative gap lengths or partial alignments) have been flagged by Stitch for investigation at a sequence level. Bioinformatics tools that could automate assembly editing based on such discrepancies are needed. 

\section*{Availability and requirements}

\subsection*{\textbf{Assembly scripts}}

\textbf{Project name:} AssembleIrysCluster.pl

\textbf{Project home page:} AssembleIrysCluster scripts are available on Github at \url{https://github.com/i5K-KINBRE-script-share/Irys-scaffolding/tree/master/KSU\_bioinfo\_lab/assemble\_SGE\_cluster}

\textbf{Operating system(s):} SGE Linux (tested on a Gentoo) cluster

\textbf{Programming language:} Perl, Rscript, Bash

\textbf{License}: AssembleIrysCluster.pl is available free of charge to academic and non-profit institutions.

\textbf{Any restrictions to use by non-academics:} Please contact authors for commercial use.

\textbf{Dependencies:} AssembleIrysCluster.pl requires DRMAA job submission libraries. RefAligner and Assembler are also required and can be provided by request by Bionano Genomics \url{http://www.bionanogenomics.com/}.

\subsection*{\textbf{Super scaffolding scripts}}

\textbf{Project name:} stitch.pl

\textbf{Project home page:} stitch scripts are available on Github at \url{https://github.com/i5K-KINBRE-script-share/Irys-scaffolding/tree/master/KSU\_bioinfo\_lab/stitch}

\textbf{Operating system(s):} MAC and LINUX (tested on Gentoo and Ubuntu)

\textbf{Programming language:} Perl, Rscript, Bash

\textbf{License}: stitch.pl is available free of charge to academic and non-profit institutions.

\textbf{Any restrictions to use by non-academics:} Please contact authors for commercial use.

\textbf{Dependencies:} stitch.pl requires BioPerl. RefAligner and Assembler are also required between iterations and can be provided by request by Bionano Genomics \url{http://www.bionanogenomics.com/}.

\subsection*{\textbf{Map summary scripts}}

\textbf{Project name:} BNGCompare.pl, bnx\_stats.pl, cmap\_stats.pl and xmap\_stats.pl

\textbf{Project home page:} all scripts are available on Github at \url{https://github.com/i5K-KINBRE-script-share/Irys-scaffolding/tree/master/KSU\_bioinfo\_lab/map\_tools} and \url{https://github.com/i5K-KINBRE-script-share/BNGCompare}

\textbf{Operating system(s):} MAC and LINUX (tested on Gentoo and Ubuntu)

\textbf{Programming language:} Perl, Rscript, Bash

\textbf{License}: bnx\_stats.pl, cmap\_stats.pl and xmap\_stats.pl are available free of charge to academic and non-profit institutions.

\textbf{Any restrictions to use by non-academics:} Please contact authors for commercial use.

\textbf{Dependencies:} bnx\_stats.pl, cmap\_stats.pl and xmap\_stats.pl have no dependencies.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Backmatter begins here                   %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{backmatter}

\section*{Competing interests}
  The authors declare that they have no competing interests.

\section*{Author's contributions}
    Text for this section \ldots

\section*{Acknowledgements}
  Text for this section \ldots
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                  The Bibliography                       %%
%%                                                         %%
%%  Bmc_mathpys.bst  will be used to                       %%
%%  create a .BBL file for submission.                     %%
%%  After submission of the .TEX file,                     %%
%%  you will be prompted to submit your .BBL file.         %%
%%                                                         %%
%%                                                         %%
%%  Note that the displayed Bibliography will not          %%
%%  necessarily be rendered by Latex exactly as specified  %%
%%  in the online Instructions for Authors.                %%
%%                                                         %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% if your bibliography is in bibtex format, use those commands:
\bibliographystyle{bmc-mathphys} % Style BST file
\bibliography{bmc_article}      % Bibliography file (usually '*.bib' )

% or include bibliography directly:
% \begin{thebibliography}
% \bibitem{b1}
% \end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Figures                       %%
%%                               %%
%% NB: this is for captions and  %%
%% Titles. All graphics must be  %%
%% submitted separately and NOT  %%
%% included in the Tex document  %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%
%% Do not use \listoffigures as most will included as separate files

\section*{Figures}
  \begin{figure}[h!]
  	\caption{\csentence{Data analysis steps.}
  		(1) Autonoise converts TIFF images of molecules to (2) BNX text files. (3) Sequence scaffolds are \textit{in silico} labeled with fa2cmap\_multi producing (4) a \textit{in silico} genome map. (5) AssembleIryscluster uses \textit{in silico} genome maps, BNX files and estimated genome size to (6) adjust molecule stretch and set assembly parameters. (7) Assembler produces (8) a BioNano genome map. (9) RefAligner aligns the BioNano genome map to the \textit{in silico} genome map producing (10) an XMAP. (11) XMAP, \textit{in silico} genome map and BioNano genome map (see arrows with dashed lines) are used by stitch to produce super scaffolded (stitched) sequence scaffolds. (13) Until no more super scaffolds are created the stitched sequence scaffolds are \textit{in silico} labeled with fa2cmap\_multi producing (14) a CMAP that is aligned to (9) the BioNano genome map and steps 10-15 are iterated. Arrows with dotted rather than dashed lines are used to as input during iterations.}
  \end{figure}
  \begin{figure}[h!]
  	\caption{\csentence{Assembly workflow for assemble\_SGE\_cluster.pl.}
  		(A) The Irys instrument produces tiff files that are converted into BNX text files. (B) One BNX file is produced for each flowcell on a chip. (C) BNX files are split by scan and aligned to the sequence reference. Stretch (bases per pixel) is recalculated for each scan from the alignment. (D) Quality check graphs are created for each pre-adjusted flowcell BNX. (E) Adjusted flowcell BNXs are merged. (F) The first assemblies are run with a variety of p-value thresholds. (G) The best first assemblies (red oval) is chosen and a version of this assembly is produced with a variety of minimum molecule length filters.}
  \end{figure}
  \begin{figure}[h!]
  \caption{\csentence{Steps of the stitch.pl algorithm.}
      BioNano genome maps (blue) are shown aligned to \textit{in silico} genome maps (green). Alignments are indicated with grey lines. CMAP orientation for \textit{in silico} genome maps is indicated with a "+" or "-" for positive or negative orientation respectively. (A) The \textit{in silico} genome map is aligned as the reference. (B) The alignment is inverted and used as input for stitch.pl. (C) The alignments are filtered based on alignment length (purple) relative to total possible alignment length (black) and confidence. Here assuming all alignments have a high confidence score and the minimum percent aligned is 30\% two alignments fail for aligning over less than 30\% of the potential alignment length for that alignment. (D) Filtering produces an XMAP of high quality alignments with short (local) alignments removed. (E) High quality scaffolding alignments are filtered for longest and highest confidence alignment for each \textit{in silico} genome map. Third alignment (unshaded) is filtered because the second alignment is the longest alignment for {in silico} genome map 2. (F) Passing alignments are used to super scaffold (captured gaps indicated in dark green). (G) Stitch is iterated and additional super scaffolding alignments are found using second best scaffolding alignments. (H) Iteration takes advantage of cases where \textit{in silico} genome maps scaffold BioNano genome maps as \textit{in silico} genome map 2 does. Stitch is run iteratively all until super scaffolding alignments are found.}
      \end{figure} 
\begin{figure}[h!]
	\caption{\csentence{Cumulative length per BNX file for \textit{T. castaneum} data generated over time.}
		Cumulative length of molecule maps > 150 kb are ploted on the y-axis (purple X), the upgrade to the V2 Irys chip (grey dashed line) is ploted and date is indicated on the x-axis. Data was generated from 03-2013 to 01-2014. Aborted runs (cumulative length = 0) excluded. }
\end{figure}
\begin{figure}[h!]
	\caption{\csentence{Comparison of the BioNano genome maps assembled from the \textit{T. castaneum} data using five sets of parameters.}
		Relaxed, default and strict "-T" parameters were set to 5e-08, 5e-09 and 5e-10. Relaxed, default and strict minimum molecule length were set to 100, 150 and 180 kb.}
\end{figure}     
\begin{figure}[h!]
	\caption{\csentence{Histogram of gap lengths in Tcas5.1.}
		Positive and negative gaps lengths for Tcas5.1 added to the automated output of stitch.pl based on filtered scaffolding alignments. The majority of gap lengths added by stitch.pl, 66, were positive (red). The remaining 26 gaps had negative lengths (purple).}
      \end{figure}                      
\begin{figure}[h!]
	\caption{\csentence{Extremely small negative gap length for \textit{in silico} genome map of scaffold 81.}
		Two XMAP alignments for \textit{in silico} genome map of sequence scaffold 81 are shown. BioNano genome maps (blue with molecule coverage shown in dark blue) align to the \textit{in silico} genome maps of scaffolds (green with contigs overlaid as translucent colored squares). Sequence scaffolds 79-83 were placed within ChLG 5 and sequence scaffolds 99-103 were placed with ChLG 7 by the \textit{T. castaneum} genetic map. (A) Half of the \textit{in silico} genome map of sequence scaffold 81 aligns with its assigned ChLG (black arrow). (B) The other half aligns with ChLG 7 (red arrow) producing a negative gap length smaller than -20 kb. The alignment that places sequence scaffold 81 with ChLG 7 disagrees with the genetic map and was manually rejected for Tcas5.2.}
      \end{figure} 

\begin{figure}[h!]
	\caption{\csentence{ChLGX before and after super scaffolding with Stitch and Hybrid Map creation.}
		(A) Alignment of Tcas5.2 \textit{in silico} genome maps to BioNano genome maps for ChLGX. (B) Alignment of Tcas5.0 \textit{in silico} genome maps to BioNano genome maps for ChLGX. (c) Alignment of Hybrid genome maps to BioNano genome maps for ChLGX. BioNano genome maps are blue with molecule coverage shown in dark blue). The \textit{in silico} genome maps are green with contigs overlaid as translucent colored squares.Only \textit{in silico} genome maps that align are displayed in IrysView. The hybrid scaffold is yellow and only new "hybridized" maps are shown in IrysView. Labels and alignments of labels are indicated with grey lines. }
      \end{figure}  
\begin{figure}[h!]
	\caption{\csentence{Putative haplotypes assembled as BioNano genome maps.}
		(A) Two BioNano genome maps (blue with molecule coverage shown in dark blue) align to the \textit{in silico} genome map of scaffold 131 (green with contigs overlaid as translucent colored squares). (B and C) Both BioNano genome maps are shown (blue) with molecule pileups (yellow). Both BioNano genome maps have similar label patterns except within the lower coverage region indicated with a black square.}
\end{figure}            


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Tables                        %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Use of \listoftables is discouraged.
%%

\section*{Tables}

\begin{table}[h!]
\caption{BioNano molecule maps from \textit{T. castaneum} filtered by minimum length. Molecule map N50, cumulative length and number of maps are listed for all three molecule length filters for the \textit{T. castaneum} genome data.}
      \begin{tabular}{cccc}
        \hline
         Minimum molecule map length (kb) & Molecule map N50 (kb) & Cumulative length (Mb) & Number of molecule maps\\ \hline
        100 & 165.35 & 82,738.71 & 503,414 \\
        150 & 202.64 & 50,579.12 & 239,558 \\ 
        180 & 232.57 & 34287.15 & 139,949 \\ \hline  
      \end{tabular}
\end{table}

\begin{table}[h!]
	\caption{\textit{T. castaneum} assembly Results. Assembly metrics for Tcas5.0 (the starting sequence scaffolds), the \textit{in silico} genome map, the BioNano genome map of assembled molecules, the automated output of Stitch (Tcas5.1), the manually currated sequence assembly (Tcas5.2) and the sequence assembly produced by the BioNano hybridScaffold software for the \textit{T. castaneum} genome.}
	\begin{tabular}{cccc}
		\hline
		& N50 (Mb)  & Number & Cumulative Length (Mb)\\ \hline
		Tcas5.0 sequence scaffolds & 1.16 & 2240 & 160.74\\
		\textit{in silico} genome map & 1.20 &  223 & 152.53\\
		BioNano genome map & 1.35 &  216 & 200.47\\
		Tcas5.1 sequence scaffolds & 3.85 & 2148 & 165.72\\
		Tcas5.2 sequence scaffolds & 4.46 & 2150 & 165.92\\ 
		Tcas BioNano hybridScaffold & 1.83 & 2210 &175.54 \\ \hline
	\end{tabular}
\end{table}
\begin{table}[h!]
\caption{Alignment of BioNano assembly to the \textit{in silico} genome map of Tcas5.0. Breadth of alignment coverage (non-redundant alignment), length of total alignment (including redundant alignments) and percent of CMAP covered (non-redundantly) were calculated for the \textit{in silico} genome map and the BioNano genome map of the \textit{T. castaneum} genome the using xmap\_stats.pl.}
      \begin{tabular}{cccc}
        \hline
           & Breadth of alignment coverage (Mb) & Length of total alignment (Mb) & Percent of CMAP aligned \\ \hline
        \textit{in silico} genome map & 124.04 & 132.40 & 81 \\
        BioNano genome map & 131.64 & 132.34 & 67 \\ \hline
      \end{tabular}
\end{table}
\begin{table}[h!]
	\caption{\textit{T. castaneum} chromosome linkage groups before and after super scaffolding. The number of sequence scaffolds in the ordered Tcas5.0 ChLG bins and the number of sequence super scaffolds and scaffolds in the Tcas5.2 ChLG bins. The number of sequence scaffolds that were unplaced in Tcas5.0 and placed with a ChLG in Tcas5.2 is also listed. }
	\begin{tabular}{cccc}
		\hline
		Chromosome linkage group (ChLG) & Tcas5.0 scaffolds & Unplaced scaffolds added in Tcas5.2 & Tcas5.2 super scaffolds \\ \hline
		X & 13 & +2 & 2\\
		2 & 18 & +1 & 10\\
		3 & 29 & +4 & 20\\
		4 & 6 & +2 & 2\\
		5 & 17 & +1 & 4\\
		6 & 12 & +6 & 6\\
		7 & 15 & - & 6\\
		8 & 14 & +1 & 8\\
		9 & 21 & - & 9\\
		10 & 12 & +2 & 10\\ \hline
		Total & 157 & 19 & 77\\ \hline
	\end{tabular}
\end{table}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Additional Files              %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Additional Files}

\subsection*{Additional file 1 --- Molecule stretch per scan in recent flowcells.} Bases per pixel (bpp) is ploted for scans 1..$n$ for each flowcell of mouse lemur molecules (purple). The first scan of each flowcell is indicated with a grey dashed line. The pre-adjusted molecule map stretch was determined by aligning molecules to the \textit{in silico} genome map. Data made available by P.A. Larsen, J. Rogers, A.D. Yoder and the Duke Lemur Center.

\subsection*{Additional file 2 --- Cumulative length and number of molecule maps per BNX file for \textit{T. castaneum} data generated over time}
    Detailed metrics for molecule maps per BNX file (cumulative length and number of maps). Columns include cumulative length of molecule maps  > 150 kb, number of molecule maps > 150 kb and date that BNX file was generated.

  \subsection*{Additional file 3 --- Molecule map metrics and histograms from \textit{T. castaneum} DNA}
    Detailed metrics for molecule maps including map N50, cumulative length and number of maps. Figures show histograms of per molecule map quality metrics including length, molecule map SNR and intensity, label count, label SNR and label intensity. Molecule maps are filter for minimum molecule lengths of 100, 150 or 180 kb.

  \subsection*{Additional file 4 --- Assembly of \textit{T. castaneum} genome maps with range of parameters}
    Detailed assembly metrics for assembled genome maps using strict, default and relaxed "-T" parameter, p-value threshold are named Relaxed-T, Default-T and Strict-T respectively. The best "-T" parameter was used for two additional assemblies with either relaxed minimum molecule length (relaxed-minlen) of 100 kb, rather than the 150 kb default, or a strict minimum molecule length (strict-minlen) of 180 kb. 

  \subsection*{Additional file 5 --- ChLGs before and after super scaffolding }
    Alignments of Tcas5.0 and Tcas5.2 \textit{in silico} genome maps to BioNano genome maps for all ChLGs. BioNano genome maps (blue with molecule coverage shown in dark blue) aligned to the \textit{in silico} genome maps (green with contigs overlaid as translucent colored squares). Alignment to both Tcas5.2 super scaffolds (top alignment) and Tcas5.0 scaffolds (bottom alignment) are shown.



\end{backmatter}
\end{document}
